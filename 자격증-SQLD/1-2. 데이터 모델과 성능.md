# 성능 데이터 모델링
## 개념
- 분석 및 설계 단계부터 데이터베이스 성능을 고려한 데이터 모델링을 수행하는 기법
- 데이터 모델을 중심으로 성능에 대한 데이터 모델링을 수행

## 수행 절차
- 데이터 모델링을 할 때 정규화를 정확하게 수행한다.
- 데이터 베이스 용량을 현재와 예상 증가량을 고려하여 조사한다.
- 데이터베이스에 발생되는 트랜잭션의 유형을 파악한다.
- 용량과 트랜잭션의 유형에 따라 반정규화를 수행한다.
- 이력모델의 조정, PK/FK 조정, 슈퍼타입/서브타입 조정 등을 수행한다.
- 성능관점에서 데이터 모델을 검증한다.

# 정규화와 성능
** 아마도 임시테이블이나 뷰를 만드는 등의 일인 것 같다.
## 개념
- 데이터의 일관성, 최소한의 중복, 최대한의 데이터 유연성을 위한 방법
- 데이터를 분해하는 과정
- 정해진 규칙을 따라 데이터를 이용하기 쉽게 만드는 일
- 데이터의 중복을 제거한다.
- 데이터 모델의 독립성을 확보한다.
- 데이터 이상현상을 줄이기 위한 설계 기법
- 엔터티를 상세화하는 과정이며 논리 데이터 모델링 수행 시점에서 고려

## 이상현상
- 삽입이상 : 삽입 시 ~
- 갱신이상 : 갱신 시 ~
- 삭제이상 : 삭제 시 ~

## 단계
- 제1정규화 : 기본키를 설정하는 단계. 원자성을 확보하는 단계
- 제2정규화 : **부분함수 종속성을 제거**한다. 기본키가 2개 이상의 속성으로 이루어진 경우(복합키) 두 개를 쪼개서 따로 테이블을 만드는 것.
- 제3정규화 : **이행함수 종속성을 제거**한다. 기본키를 제외한 컬럼 간의 종속성을 제거한다.
- BCNF
	- 기본키를 제외하고 후보키가 있는 경우, 후보키가 기본키를 종속시키면 분해
	- 결정자 함수 종속성을 제거하는 단계
	- 강한 제3정규화
- 제4정규화 : 여러 컬럼들이 하나의 컬럼을 종속 시키는 경우 분해하여 다중값 종속성을 제거 
- 제5정규화 : 조인에 의한 종속성이 발생되는 경우 분해

## 정규화 주의사항
- 모든 정규화는 이전 정규화를 만족해야 한다.
- 이상현상은 제거되지만 테이블의 분해로 데이터 조인의 발생이 많아지고, 이는 조회 성능 저하로 이어질 수 있다. (I/O 증가 및 조인 연산 증가) -> 성능을 높이려면 반정규화를 해야한다.
- 단일 테이블 조회시엔 데이터 중복이 제거되어 조회 성능이 향상될 여지가 있다.


# 반정규화

## 개념
- 데이터베이스의 성능 향상을 위해 정규화로 쪼개 놓은 내용을 합치거나 다른 형태로 만드는 것.
- 조회 성능을 향상시킬 수 있지만 유연성은 낮아진다. =>
- 시스템 성능 향상 및 개발 운영의 단순화를 위해 정규화된 데이터 모델을 중복, 통합, 분리하는 데이터 모델링 기법을 이야기한다.
- 데이터 모델을 
- 반정규화 =/ 비 정규화
	- 비정규화 : 정규화를 하지 않음
	- 반정규화 = 역정규화

## 수행해야하는 경우 (=>성능 영향이 있을 때!)
- 정규화를 잘하면 종속성, 활용성이 향상되지만 수행 속도가 느려진 경우
- 다량의 범위를 자주 처리해야하는 경우
- 특정 범위의 데이터만 자주 처리하는 경우
- 요약/집계 정보를 자주 사용하는 경우

## 절차
1. 대상 조사 및 검토 (문제 파악)
	- 어떤 부분을 반정규화해야할지 데이터 처리범위, 통계성 확인
	- 대량의 범위 처리 및 빈도수, 통계성 프로세스, 테이블 조인 수이 몇 개나 되는지 확인
2. 다른 방법 검토
	- 반정규화가 아닌 다른 방법(클러스터링, 뷰, 인덱스, 응용프로그램, 파티셔닝 처리 등)으로 해결할 수 있는지 확인
3. 반정규화 수행
	- 테이블, 속성, 관계 등을 반정규화 한다.
	- 테이블 반정규화, 속성의 반정규화, 관계의 반정규화

## 기법
- 테이블 반정규화
	- 테이블 병합
		- 1:1 관계 테이블 병합
		- 1:M 관계 테이블 병합
		- 슈퍼/서브 타입 테이블 병합
	- 테이블 분할
		- 수직 분할 : **컬럼** 단위의 테이블을 디스크 I/O를 분산 처리하기 위해 테이블을 1:1로 분리하여 성능 향상
		- 수평 분할 : **행** 단위로 집중 발생된는 트랜잭션을 분석하여 디스크 I/O 밑 데이터 접근의 효율성을 높여 성능을 향상하기 위해 행 단위로 테이블을 쪼갬
	- 테이블 추가
		- 중복 테이블 추가 : 다른 업무이거나 서버가 다른 경우, 동일한 테이블 구조를 중복하여 원격 조인을 제거하고 성능을 향상
		- 통계 테이블 추가 : SUM, AVG 등을 미리 수행하여 계산해둠으로써 조회 시 성능을 향상
		- 이력 테이블 추가
		- 부분 테이블 추가
- 컬럼의 반정규화
	- 중복컬럼 추가
	- 파생컬럼추가
	- 이력테이블 컬럼추가
	- PK에 의한 컬럼추가
	- 응용프로그램 오작동을 위한 컬럼추가
- 데이터를 1억건씩 조회해서 찾아야했는데, 파생컬럼을 추가해 where에 조건을 빼서 한다던지
- 관계의 반정규화
	- 중복관계 추가

# 데이터 베이스 구조
## 데이터 베이스 구조
- 중앙 집중형 데이터 베이스 : 한 대의 물리적 시스템에 여러 명의 사용자가 접속해서 사용하는 데이터베이스라고 한다.
- 분산 데이터 베이스 : 물리적으로 떨어져있지만 네트워크로 연결된 단일 데이터베이스 이미지를 보여주고 분산된 작업을 하는 데이터베이스

## 분산 데이터 베이스의 투명성
- 분할 투명성 : 
- 위치 투명성
- 지역 사상 투명성
		고객이 데이터베이스를 쓸 때 데이터 베이스가 어디에 있는지, 얼마나 분할되어 있는지 알 필요 없어야 한다.
- 중복 투명성 : 분산시켜놨어도 서비스할 때는 이상없어야 한다.
- 장애 투명성
- 병행 투명성

## 분산 데이터 베이스 설계 방식
- 상향식 : 지역 스키마 작성 후 -> 전역 스키마를 만든다.
- 하향식 : 전역 스키마 작성 후 -> 지역 스키마를 만든다.
 
## 장단점
- 장점
	- 데이터 베이스 신뢰성과 가용성이 높다.
	- 병렬 처리를 수행하기 때문에 빠르다.
	- 시스템 용량 확장이 쉽다.
- 단점
	- 데이터베이스가 여러 네트워크를 통해서 분리되어 있기 때문에 관리 및 통제가 어렵다.
	- 보안관리가 어렵다
	- 데이터 무결성 관리가 어렵다
	- 데이터베이스 설계가 복잡하다

